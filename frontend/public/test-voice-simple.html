<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>èªéŸ³æ¸¬è©¦</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 600px;
            margin: 50px auto;
            padding: 20px;
        }
        button {
            padding: 20px 40px;
            font-size: 24px;
            cursor: pointer;
            margin: 10px;
        }
        #status {
            margin: 20px 0;
            padding: 15px;
            background: #f0f0f0;
            border-radius: 8px;
        }
        #result {
            margin: 20px 0;
            padding: 15px;
            background: #e8f5e9;
            border-radius: 8px;
            min-height: 50px;
        }
    </style>
</head>
<body>
    <h1>ğŸ¤ èªéŸ³è¾¨è­˜æ¸¬è©¦</h1>

    <div id="status">
        <strong>ç‹€æ…‹ï¼š</strong><span id="statusText">ç­‰å¾…ä¸­...</span>
    </div>

    <button id="startBtn">ğŸ¤ é–‹å§‹éŒ„éŸ³</button>
    <button id="stopBtn">ğŸ›‘ åœæ­¢</button>

    <div id="result">
        <strong>è¾¨è­˜çµæœï¼š</strong><br>
        <span id="resultText">ï¼ˆå°šæœªé–‹å§‹ï¼‰</span>
    </div>

    <div id="log" style="margin-top: 20px; padding: 15px; background: #fff3e0; border-radius: 8px;">
        <strong>é™¤éŒ¯è¨Šæ¯ï¼š</strong>
        <div id="logContent"></div>
    </div>

    <script>
        const statusText = document.getElementById('statusText');
        const resultText = document.getElementById('resultText');
        const startBtn = document.getElementById('startBtn');
        const stopBtn = document.getElementById('stopBtn');
        const logContent = document.getElementById('logContent');

        let recognition = null;

        function log(message) {
            console.log(message);
            const p = document.createElement('p');
            p.textContent = message;
            p.style.margin = '5px 0';
            logContent.appendChild(p);
        }

        // æª¢æŸ¥ç€è¦½å™¨æ”¯æ´
        log('ğŸ” æª¢æŸ¥ç€è¦½å™¨æ”¯æ´...');
        log('Navigator: ' + navigator.userAgent);

        if (!('webkitSpeechRecognition' in window) && !('SpeechRecognition' in window)) {
            log('âŒ ç€è¦½å™¨ä¸æ”¯æ´èªéŸ³è¾¨è­˜');
            statusText.textContent = 'âŒ ç€è¦½å™¨ä¸æ”¯æ´èªéŸ³è¾¨è­˜';
            startBtn.disabled = true;
        } else {
            log('âœ… ç€è¦½å™¨æ”¯æ´èªéŸ³è¾¨è­˜');

            const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
            recognition = new SpeechRecognition();

            recognition.lang = 'zh-TW';
            recognition.continuous = false;
            recognition.interimResults = false;

            log('âœ… èªéŸ³è¾¨è­˜ç‰©ä»¶å·²å»ºç«‹');

            recognition.onstart = () => {
                log('ğŸ¤ é–‹å§‹éŒ„éŸ³');
                statusText.textContent = 'ğŸ¤ æ­£åœ¨éŒ„éŸ³...';
                startBtn.disabled = true;
            };

            recognition.onresult = (event) => {
                const transcript = event.results[0][0].transcript;
                log('âœ… è¾¨è­˜çµæœ: ' + transcript);
                resultText.textContent = transcript;
            };

            recognition.onerror = (event) => {
                log('âŒ éŒ¯èª¤: ' + event.error);
                statusText.textContent = 'âŒ éŒ¯èª¤: ' + event.error;
                startBtn.disabled = false;
            };

            recognition.onend = () => {
                log('â¹ï¸ éŒ„éŸ³çµæŸ');
                statusText.textContent = 'â¹ï¸ å·²åœæ­¢';
                startBtn.disabled = false;
            };

            startBtn.addEventListener('click', () => {
                log('ğŸ‘† æŒ‰éˆ•è¢«é»æ“Š');
                try {
                    recognition.start();
                    log('â–¶ï¸ å·²å‘¼å« start()');
                } catch (error) {
                    log('âŒ å•Ÿå‹•å¤±æ•—: ' + error.message);
                }
            });

            stopBtn.addEventListener('click', () => {
                log('ğŸ›‘ åœæ­¢æŒ‰éˆ•è¢«é»æ“Š');
                recognition.stop();
            });
        }
    </script>
</body>
</html>
